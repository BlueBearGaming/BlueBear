parameters:
    # engine
    bluebear.engine.engine: BlueBear\EngineBundle\Engine\Engine
    bluebear.engine.context_factory: BlueBear\EngineBundle\Engine\Context\ContextFactory

    # events subscribers
    bluebear.engine.event.mapitem_leave_subscriber: BlueBear\EngineBundle\Event\MapItem\MapItemLeaveSubscriber
    bluebear.engine.event.mapitem_subscriber: BlueBear\EngineBundle\Event\Subscriber\MapItemSubscriber
    bluebear.engine.event.map_subscriber: BlueBear\EngineBundle\Event\Subscriber\MapSubscriber
    bluebear.engine.event.engine_subscriber: BlueBear\EngineBundle\Event\Subscriber\EngineSubscriber

    # pathfinder
    bluebear.engine.path_finder: BlueBear\EngineBundle\Path\PathFinder

    # ruler
    bluebear.engine.ruler: BlueBear\EngineBundle\Rules\Ruler

services:
    # engine
    bluebear.engine.engine:
        class: %bluebear.engine.engine%
        calls:
            - [setEventDispatcher, [@event_dispatcher]]
            - [setSerializer, [@jms_serializer]]
            - [setAllowedEvents, [%bluebear.engine.events%]]

    # events subscribers
    bluebear.engine.event.mapitem_subscriber:
        class: %bluebear.engine.event.mapitem_subscriber%
        tags:
            - {name: kernel.event_subscriber}
        calls:
            - [setContainer, [@service_container]]

    bluebear.engine.event.map_subscriber:
        class: %bluebear.engine.event.map_subscriber%
        tags:
            - {name: kernel.event_subscriber}
        calls:
            - [setContextFactory, [@bluebear.engine.context_factory]]
            - [setContainer, [@service_container]]

    bluebear.engine.event.engine_subscriber:
        class: %bluebear.engine.event.engine_subscriber%
        tags:
            - {name: kernel.event_subscriber}
        calls:
            - [setEventDispatcher, [@event_dispatcher]]
            - [setContextManager, [@bluebear.manager.context]]

    bluebear.engine.context_factory:
        class: %bluebear.engine.context_factory%
        calls:
            - [setMapManager, [@bluebear.manager.map]]
            - [setDoctrine, [@doctrine]]

    # pathfinder
    bluebear.engine.path_finder:
        class: %bluebear.engine.path_finder%
        calls:
            - [setRuler, [@bluebear.engine.ruler]]

    # ruler
    bluebear.engine.ruler:
        class: %bluebear.engine.ruler%
