{# list of pencil set #}
{% block pencil_set_list_widget %}
    {{ form_widget(form) }}

    <script>
        $(document).on('ready', function () {
            // removing already added items from select
            $(window).on('add.mopa-collection-item', function (event, collection) {
                var ids = [];

                collection.find('select').each(function () {
                    console.log($(this), $(this).val());
                });

                console.log('data', ids);
            });
        });
    </script>
{% endblock %}

{# list of generic items #}
{% block table_list %}
    {% if list|length > 0 %}
        {% set fields = fields is defined ? fields : ['id', 'label'] %}

        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                <tr>
                    {% for field in fields %}
                        <th>{{ field | capitalize }}</th>
                    {% endfor %}
                </tr>
                </thead>
                <tbody>
                {% for entity in list %}
                    <tr>
                        {% for field in fields %}
                            <td>{{ attribute(entity, field) }}</td>
                        {% endfor %}
                        <td>
                            <a href="{{ path(editRoute, {id: entity.id}) }}"
                               class="btn btn-sm">edit</a>
                            <a href="{{ path(deleteRoute, {id: entity.id}) }}"
                               class="item-delete btn btn-sm">delete</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        No record yet
    {% endif %}
{% endblock %}

{# generic menu #}
{% block menu %}
    {% if menu|length > 0 %}
        {% for route, item in menu %}
            <ul class="nav nav-pills nav-stacked">
                <li><a href="{{ path(route) }}">{{ item }}</a></li>
            </ul>
        {% endfor %}
    {% endif %}
{% endblock %}

{# generic edition form #}
{% block generic_form %}
    {% set containerClass = containerClass is defined ? containerClass : '' %}
    {% set title = title is defined ? title : null %}
    {% set encType = (form.vars.multipart) ? 'multipart/form-data' : 'application/x-www-form-urlencoded' %}

    {% if title %}
        <h1>{{ title }}</h1>
    {% endif %}

    <div class="well {{ containerClass }}">
        <form action="{{ path(action, { id: form.vars.value.id}) }}" method="post" class="form-horizontal"
              enctype="{{ encType }}">
            {{ form_widget(form) }}

            <div class="form-group">
                <div class="col-lg-12 col-lg-offset-9">
                    <a href="{{ path(returnRoute) }}" class="right btn"><i class="fa fa-arrow-circle-left"></i>&nbsp;
                        &nbsp;cancel</a>
                    <input type="submit" value="save" class="right btn btn-default"/>
                </div>
            </div>
        </form>
    </div>
{% endblock %}

{% block resource_widget %}
    {% set file = form.vars.data %}
    <div class="fileupload-widget">
        <input type="hidden" {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %}/>
        <span class="btn btn-labeled btn-info fileupload-button{% if file %} disabled{% endif %}">
            <span class="btn-label icon fa fa-plus"></span>
            Upload a file
            <input type="file"
                   data-url="{{ oneup_uploader_endpoint(form.vars.endpoint) }}"
                   data-maxsize="{{ oneup_uploader_maxsize(form.vars.endpoint) }}">
        </span>

        {% if file %}
            <span class="btn btn-outline fileupload-file">
                <button class="close" type="button">×</button>
                <span class="fileupload-filename">
                    {{ file.originalFileName }}
                </span>
            </span>
        {% else %}
            <span class="btn btn-outline fileupload-file" style="display: none">
                <button class="close" type="button">×</button>
                <span class="fileupload-filename"></span>
            </span>
        {% endif %}
        <br>
        <div class="progress" style="display: none; height:2px">
            <div class="progress-bar"></div>
        </div>
        <div class="alert alert-danger" style="display:none;"></div>
    </div>
{% endblock %}

{% block resource_image_widget %}
    {% set file = form.vars.data %}
    {% if file %}
        {% set fileUrl = asset('resources/images/' ~ file.fileName) %}
        <a href="{{ fileUrl }}" title="{{ file.originalFileName }}"><img src="{{ fileUrl }}" class="img-thumbnail col-lg-4 pull-right"></a>
    {% endif %}
    {{ block('resource_widget') }}
    <div class="clear"></div>
{% endblock %}